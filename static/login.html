<!doctype html>
<html lang="fr" data-fr-scheme="system">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://static.data.gouv.fr/_themes/gouvfr/less/index.css?_=1.1.2" rel="stylesheet">
    <link href="https://static.data.gouv.fr/_themes/gouvfr/js/index.css?_=1.1.2" rel="stylesheet">
    <link rel="stylesheet" href="dsfr/dsfr.min.css">
    <meta name="theme-color" content="#000091"><!-- Défini la couleur de thème du navigateur (Safari/Android) -->
    <link rel="apple-touch-icon" href="favicon/apple-touch-icon.png"><!-- 180×180 -->
    <link rel="icon" href="favicon/favicon.svg" type="image/svg+xml">
    <link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon"><!-- 32×32 -->
    <link rel="manifest" href="favicon/manifest.webmanifest" crossorigin="use-credentials">
    <!-- Modifier les chemins relatifs des favicons en fonction de la structure du projet -->
    <!-- Dans le fichier manifest.webmanifest aussi, modifier les chemins vers les images -->
    <title>Bienvenue sur Unisup.gouv.fr</title>
</head>
<body>
    <header role="banner" class="fr-header fr-mb-5v">
        <div class="fr-header__body">
            <div class="fr-container">
                <div class="fr-header__body-row">
                    <div class="fr-header__brand fr-enlarge-link">
                        <div class="fr-header__brand-top">
                            <div class="fr-header__logo">
                                <p class="fr-logo">
                                    Unisup
                                </p>
                            </div>
                            <div class="fr-header__navbar">
                                <button class="fr-btn--menu fr-btn" data-fr-opened="false" aria-controls="modal-406"
                                    aria-haspopup="menu" id="button-407" title="Menu">
                                    Menu
                                </button>
                            </div>
                        </div>
                        <div class="fr-header__service">
                            <a href="index.html"
                                title="Accueil - [À MODIFIER - Nom du site / service] - [À MODIFIER - nom de l’entité (ministère , secrétariat d‘état, gouvernement)]">
                                <p class="fr-header__service-title">Unisup</p>
                            </a>
                            <p class="fr-header__service-tagline">Entrez dans l’enseignement supérieur</p>
                        </div>
                    </div>
                    <div class="fr-header__tools">
                        <div class="fr-header__tools-links">
                            <ul class="fr-links-group">
                                <li>
                                    <a class="fr-link fr-fi-lock-line" href="login.html">Se connecter</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="fr-header__menu fr-modal" id="modal-406" aria-labelledby="button-407">
            <div class="fr-container">
                <button class="fr-link--close fr-link" aria-controls="modal-406">Fermer</button>
                <div class="fr-header__menu-links">
                </div>
                <nav class="fr-nav" id="navigation-408" role="navigation" aria-label="Menu principal">
                    <ul class="fr-nav__list">
                        <li class="fr-nav__item">
                            <a class="fr-nav__link" href="index.html" target="_self">Accueil</a>
                        </li>
                        <li class="fr-nav__item">
                            <a class="fr-nav__link" href="./student/calendrier.html" target="_self">Calendrier</a>
                        </li>
                        <li class="fr-nav__item">
                            <a class="fr-nav__link" href="./student/formations.html" target="_self">Formations</a>
                        </li>
                        <li class="fr-nav__item">
                            <a class="fr-nav__link" href="#" target="_self">Professions</a>
                        </li>
                        <li class="fr-nav__item">
                            <a class="fr-nav__link" href="./student/profil.html" target="_self">Profil</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    <section class="py-xl py-lg-lg bg-grey-50">
        <div class="container">
            <div class="row">
                <div class="col-6 text-align-center offset-3 form-container col-md-12 offset-md-0">
                    <form id="login" class="form" method="post" action="login.html">
                        <fieldset>
                            <legend class="h2 mb-xl">Inscription</legend>
                            <input id="next" name="next" type="hidden" value="/fr/datasets/">
                            <div class="field">
                                <label for="codeine" class="required">
                                    Code INE
                                </label>
                                <input type="text" autocomplete="off" id="username" placeholder="Code INE" required></input>
                            </div>
                            <div class="field">
                                <label for="password" class="required">
                                    Mot de passe
                                </label>
                                <input id="password" name="password" type="password" autocomplete="off" required>
                            </div>
                            <div class="field field-checkbox">
                                <input id="remember" name="remember" type="checkbox" >
                                <label for="remember">
                                    Se souvenir de moi
                                </label>
                            </div>
                            <button type="submit" value="Submit Form" class="btn btn-primary form-submit">Se connecter</button>
                            <input id="csrf_token" name="csrf_token" type="hidden"value="IjVhMzk2ZmMwZTYxYjVlMTJjZWNlZWExMGY3ZjdmNTBjZjgzNmNiNjki.Ya4WIw.iuhKXbgvfCSQPojpasSP0kPAD8k">
                            <div class="mt-lg">
                                <p class="fs-sm mb-sm">
                                    Mot de passe oublié ?
                                    <a href="/fr/reset?next=%2Ffr%2Flogin">
                                        Récupérer votre mot de passe
                                    </a>
                                </p>
                                <p class="fs-sm mb-sm">
                                    Instructions de confirmation non reçues ?
                                    <a href="/fr/confirm">
                                        Renvoyer les instructions
                                    </a>
                                </p>
                            </div>
                        </fieldset>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <footer class="fr-footer" role="contentinfo" id="footer-942">
        <div class="fr-container">
            <div class="fr-footer__body">
                <div class="fr-footer__brand fr-enlarge-link">
                    <a href="/" title="Retour à l’accueil">
                        <p class="fr-logo">
                            république
                            <br>française
                        </p>
                    </a>
                </div>
                <div class="fr-footer__content">
                    <ul class="fr-footer__content-list">
                        <li class="fr-footer__content-item">
                            <a class="fr-footer__content-link" href="https://legifrance.gouv.fr">legifrance.gouv.fr</a>
                        </li>
                        <li class="fr-footer__content-item">
                            <a class="fr-footer__content-link" href="https://gouvernement.fr">gouvernement.fr</a>
                        </li>
                        <li class="fr-footer__content-item">
                            <a class="fr-footer__content-link" href="https://service-public.fr">service-public.fr</a>
                        </li>
                        <li class="fr-footer__content-item">
                            <a class="fr-footer__content-link" href="https://data.gouv.fr">data.gouv.fr</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="fr-footer__bottom">
                <ul class="fr-footer__bottom-list">
                    <li class="fr-footer__bottom-item">
                        <a class="fr-footer__bottom-link" href="#">Plan du site</a>
                    </li>
                    <li class="fr-footer__bottom-item">
                        <a class="fr-footer__bottom-link" href="#">Accessibilité : non/partiellement/totalement
                            conforme</a>
                    </li>
                    <li class="fr-footer__bottom-item">
                        <a class="fr-footer__bottom-link" href="#">Mentions légales</a>
                    </li>
                    <li class="fr-footer__bottom-item">
                        <a class="fr-footer__bottom-link" href="#">Données personnelles</a>
                    </li>
                    <li class="fr-footer__bottom-item">
                        <a class="fr-footer__bottom-link" href="#">Gestion des cookies</a>
                    </li>
                </ul>
                <div class="fr-footer__bottom-copy">
                    <p>Sauf mention contraire, tous les contenus de ce site sont sous <a
                            href="https://github.com/etalab/licence-ouverte/blob/master/LO.md" target="_blank">licence
                            etalab-2.0</a>
                    </p>
                </div>
            </div>
        </div>
    </footer>
    <!-- Script en version es6 module et nomodule pour les navigateurs le ne supportant pas -->
    <script type="module" src="dsfr/dsfr.module.min.js"></script>
    <script type="text/javascript" nomodule src="dsfr/dsfr.nomodule.min.js"></script>
    <script>
       const form = document.getElementById('login')
			form.addEventListener('submit', login)

			async function login(event) {
				event.preventDefault()
				const username = document.getElementById('username').value
				const password = document.getElementById('password').value

				const result = await fetch('/api/login', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({
						username,
						password
					})
				}).then((res) => res.json())

				if (result.status === 'ok') {
					// everythign went fine
					console.log('Got the token: ', result.data)
					localStorage.setItem('token', result.data)
					window.location.href = "student/profil.html";
				} else {
					alert(result.error)
				}
			}
    </script>
</body>

</html>